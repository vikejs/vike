import { Link, RepoLink } from '@brillout/docpress'
import { UiFrameworkExtension, ConfigSpec, ProvidedBy } from '../../components'

<ConfigSpec
  env={<>client, and server if <Link href="/ssr"><code>ssr: true</code></Link></>}
  cumulative
  providedBy={<ProvidedBy>the <code>+Layout</code> setting</ProvidedBy>}
/>

> **What are layouts?**
>
> Pages usually share a common layout, like a shared header, sidebar, and footer. The `+Layout` setting lets you define such shared layout.
>
> You can define multiple layouts: some pages can share one layout while other pages share another one. For example, admin and marketing pages typically have different layouts.

The component defined by the `+Layout` setting wraps the component defined by <Link href="/Page">`+Page`</Link>.

```jsx
<Layout>     ⟸ component defined by +Layout
  <Page />   ⟸ component defined by +Page
</Layout>
```

To define a global layout applying to all your pages:

```tsx
// /pages/+Layout.tsx

export { Layout }

import React from 'react'

// `children` includes the +Page component (and all inner +Layout components)
function Layout({ children }: { children: React.ReactNode }) {
  return (
    <>
      <Navigation />
      <Content>{children}</Content>
    </>
  )
}
function Navigation() {
  /* ... */
}
function Content() {
  /* ... */
}
```

> Don't forget to use `children` (or [`<slot>`](https://vuejs.org/guide/components/slots.html) if you use Vue).

> See <Link href="/config#inheritance" /> for an explanation of why `/pages/+Layout.jsx` applies to all pages.

> If you're adding a wrapper component required for installing a tool, we recommend using <Link href="/Wrapper">`<Wrapper>`</Link> instead.


## Multiple

You can define several layouts that apply to different groups of pages.

```yaml
# Marketing pages share a layout
pages/(marketing)/+Layout.js
pages/(marketing)/index/+Page.js    # URL: /
pages/(marketing)/about/+Page.js    # URL: /about

# Admin pages share another layout
pages/admin-panel/+Layout.js
pages/admin-panel/index/+Page.js    # URL: /admin-panel
pages/admin-panel/users/+Page.js    # URL: /admin-panel/users
```

> The directory `(marketing)` is skipped by Filesystem Routing, see <Link href="/routing#filesystem-routing" />.

> You can use <Link href="/config#clear-js">`.clear.js`</Link> and <Link href="/config#default-js">`.default.js`</Link> to control the inheritance chain.

> See also: <Link href="/config#inheritance"/>


## Nested

You can define layouts that nest into each other:

```yaml
# Global outer layout that applies to all pages
pages/+Layout.js
# Inner layout nested into the global outer layout, for marketing pages
pages/(marketing)/+Layout.js
# Inner layout nested into the global outer layout, for admin pages
pages/admin-panel/+Layout.js
```

Here `pages/+Layout.js` applies to all pages, including the marketing and admin pages.

> The `Layout` setting is cumulative: `pages/(marketing)/+Layout.js` doesn't override `pages/+Layout.js`. Instead, the `<Layout>` components nest within each other:
> ```jsx
> <Layout>      ⟸ pages/+Layout.js
>   <Layout>    ⟸ pages/(marketing)/+Layout.js
>     <Page />  ⟸ pages/(marketing)/about-us/+Page.js
>   </Layout>
> </Layout>
> ```
>
> You can use <Link href="/config#clear-js">`.clear.js`</Link> and <Link href="/config#default-js">`.default.js`</Link> to control the inheritance chain.


You can also implement same-page navigations such as tabs:

```
/product/42/pricing                   /product/42/reviews
+------------------+                  +-----------------+
| Macbook          |                  | Macbook         |
| ...              |                  | ...             |
| +--------------+ |                  | +-------------+ |
| | Pricing      | |  +------------>  | | Reviews     | |
| | ...          | |                  | | ...         | |
| +--------------+ |                  | +-------------+ |
+------------------+                  +-----------------+
```

```yaml
pages/+Layout.js                      # Global layout (shared among all pages)
pages/product/@id/+Layout.js          # Outer content ("Macbook" ...)
pages/product/@id/pricing/+Page.js    # Inner content ("Pricing" ...)
pages/product/@id/reviews/+Page.js    # Inner content ("Reviews" ...)
```

> If your nested layout isn't associated with a URL (if the pricing and reviews tabs share the same URL `/product/42`) then you can use a stateful component instead of `<Layout>`.

To avoid the page scrolling to the top, make sure to use:
- <Link href="/keepScrollPosition" /> or
- <Link href="/clientRouting#settings">`<a href="/product/42/reviews" keep-scroll-position />`</Link>

Examples:
- [React](https://github.com/vikejs/vike-react/blob/main/examples/full/pages/starship)
- [Vue](https://github.com/vikejs/vike-vue/blob/main/examples/full/pages/starship)
- [Solid](https://github.com/vikejs/vike-solid/tree/main/examples/full/pages/starship)


## Data fetching

To fetch data for your layouts see:
- <Link href="/data-fetching#page-data-with-tools" />
- [#1833 - Make `+data` and `+onBeforeRender` cumulative](https://github.com/vikejs/vike/issues/1833)


## `pageContext`

You can access <Link href="/pageContext">the `pageContext` object</Link> by using <Link href="/usePageContext">`usePageContext()`</Link>.

```tsx
// /pages/+Layout.tsx

export { Layout }

import React from 'react'
import { usePageContext } from 'vike-react/usePageContext' // or vike-{vue,solid}

function Layout({ children }: { children: React.ReactNode }) {
  const pageContext = usePageContext()
  // ...
}
```


## Without `vike-{react,vue,solid}`

The following is for users that don't use a <UiFrameworkExtension />.

#### The simple way

A simple way to implement layouts is to manually wrap your `<Page>` components:

```tsx
// /pages/index/+Page.tsx

export { Page }

import { LayoutDefault } from '../layouts/LayoutDefault'

function Page() {
  return <LayoutDefault>{/* ... */}</LayoutDefault>
}
```

```tsx
// /pages/admin/+Page.tsx

export { Page }

import { LayoutDashboard } from '../layouts/LayoutDashboard'

function Page() {
  return <LayoutDashboard>{/* ... */}</LayoutDashboard>
}
```

#### With a custom setting

You can implement the `Layout` setting yourself by using <Link href="/meta">meta</Link>.

Examples:
 - <Link href="/meta#example-layout" doNotInferSectionTitle />
 - [`vike-react` source code](https://github.com/vikejs/vike-react/blob/main/packages/vike-react)
 - [`vike-vue` source code](https://github.com/vikejs/vike-vue/blob/main/packages/vike-vue)
 - [`vike-solid` source code](https://github.com/vikejs/vike-solid/blob/main/vike-solid)


#### Nested Layout

See the <Link href="#nested" /> section above. For smooth nested layout navigation, we recommend using <Link href="/clientRouting">Client Routing</Link>. (Using <Link href="/server-routing">Server Routing</Link> leads to full page reloads which usually isn't acceptable for same-page navigations.)


## See also

- <Link href="/Wrapper" />
- <Link href="/Page" />
- <Link href="/settings" />
