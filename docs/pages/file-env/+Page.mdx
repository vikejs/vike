import { CodeBlockTransformer, Link } from '@brillout/docpress'

For any file, adding `.server.js` / `.client.js` **guarantees** the environment in which it's loaded.

For <Link href="/config#files">`+` files</Link>, adding `.server.js` / `.client.js` / `.shared.js` / `.ssr.js` **modifies** the environment.

> See also:
> - <Link href="/config#clear-js" doNotInferSectionTitle noBreadcrumb />
> - <Link href="/config#default-js" doNotInferSectionTitle noBreadcrumb />

## For all files

### `.server.js`

The most common use case for `.server.js` is to ensure that a file that contains secret information is never accidentally leaked to the client-side (and thus made public).

```ts
// /server/database/credentials.server.ts

// This file should *never* be imported by client-side code.
// We use .server.ts to guarantee that.
export default {
  password: 'WLa!9HW?E10a'
}
```

> In this example, it's crucial that `credentials.server.js` is never loaded by the client-side: otherwise, because client-side JavaScript is public, everyone could read the password defined in `credentials.server.js`.

If some client-side code does load `credentials.server.js` then Vike throws an error and aborts any attempt to build for production. (In development Vike shows a warning.)

<CodeBlockTransformer lineBreak="white-space">
```
[vike][Wrong Usage] Server-only module /server/database/credentials.server.js (https://vike.dev/file-env) imported on the client-side by /pages/product/@id/+Page.js
```
</CodeBlockTransformer>


### `.client.js`

You can use `.client.js` to ensure that a file always runs on the client-side.

```ts
// /utils/someClientCode.client.ts

// This code only works in the browser; we use .client.ts to assert that this file is
// never loaded on the server-side.

window.onclick = () => {
  // ...
}
```


## For `+` files

For <Link href="/config#files">`+` files</Link>, the most common use case is to change the environment of <Link href="/hooks">Vike hooks</Link>. Most notably the <Link href="/data">`data()` hook</Link>.

For example, by renaming `+data.js` to `+data.shared.js`/`+data.server.js`/`+data.client.js` you tell Vike in which environment `data()` should be loaded and executed, see <Link href="/data#environment" />.

> Essentially, it's a simpler way to set the <Link href="/meta#example-modify-data-env">`meta.env` setting</Link> of a `+` file.
> Adding `.server.js`/`.client.js`/`.shared` to a `+` file, for example `/pages/product/@id/+data.js`, is equivalent to:
>
> ```ts
> // /pages/product/@id/+config.ts
>
> import type { Config } from 'vike/types'
>
> export default {
>   meta: {
>     data: {
>       // .shared.js
>       env: { server: true, client: true },
>       // .server.js
>       env: { server: true, client: false },
>       // .client.js
>       env: { server: false, client: true }
>     }
>   }
> } satisfies Config
> ```

### `.ssr.js`

Hooks with `.ssr.js` behave like `.server.js` but **run only during SSR** (initial page load on the server) â€” not during client-side navigation (<Link href="/pageContext.json">`pageContext.json` requests</Link>).

It's commonly used to initialize stores during SSR (e.g. Pinia and Redux), see: <Link href="/onCreatePageContext#use-case-store" doNotInferSectionTitle />.

> Using `.ssr.js` instead of `.server.js` prevents unnecessary <Link href="/pageContext.json">`pageContext.json` requests</Link> during client-side navigation.


## See also

- <Link href="/config#clear-js" doNotInferSectionTitle />
- <Link href="/config#default-js" doNotInferSectionTitle />
- <Link href="/meta" />
